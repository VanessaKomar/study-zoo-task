services:
  zoo-task:
    build: .
    container_name: zoo-task
    env_file:
      - ".env${ENV:-}"
    environment:
      - SESSION_ID=${SESSION_ID:-default-session}
    volumes:
      - ./data/zoo_config:/app/config
      - ./data/zoo_logs:/app/chat_Log
      - ./data/zoo_summaries:/app/chat_Log_Summary
      - ./data/zoo_histories:/app/chat_History
    ports:
      - "5000:80"
    restart: unless-stopped

  ngrok:
    image: ngrok/ngrok:latest
    container_name: zoo-ngrok
    environment:
      NGROK_AUTHTOKEN: "${NGROK_AUTHTOKEN}"
    command: >
      http --url=${NGROK_DOMAIN} --scheme=https host.docker.internal:5000
    ports:
      - "4040:4040"  # ngrok dashboard 
    extra_hosts:
      - "host.docker.internal:host-gateway"
    restart: unless-stopped